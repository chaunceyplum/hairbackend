generator client {
  provider             = "prisma-client-py"
  recursive_type_depth = "5"
  interface            = "sync"
}

datasource db {
  provider = "postgresql"
  url      = "postgres://gtfixtxgrbgrze:04ca58c50b220c61df03a4f4e9bcde65e3e31e596f7fcc91aa606429e3857c4a@ec2-52-54-212-232.compute-1.amazonaws.com:5432/d8pqm4p4gon5th"
}

model Appointment {
  appointmentId   Int          @id @unique @default(autoincrement())
  fcustomerId     Int
  fbarberId       Int
  Date            DateTime
  appointmentDate DateTime
  phoneNumber     String
  customer        Customer     @relation(fields: [fcustomerId,phoneNumber], references: [customerId,phonenumber])
  barber          Barber       @relation(fields: [fbarberId], references: [barberid])
  transaction     Transaction?
}

model Barber {
  barberid     Int           @id @unique @default(autoincrement())
  firstname    String
  appointments Appointment[]
  transactions Transaction[]
}

model Customer {
  customerId       Int           @id @unique @default(autoincrement())
  firstname        String
  lastname         String
  city             String
  phonenumber      String
  ffavoriteBarber  Int           @default(1)
  email            String        @unique
  password         String
  isLoggedIn       Boolean       @default(false)
  is_authenticated Boolean
  is_active        Boolean
  is_anonymous     Boolean
  appointments     Appointment[]
  transactions     Transaction[]
  contact          Contact?

  @@unique([customerId, phonenumber])
}

model Transaction {
  transactionId  Int         @id @unique @default(autoincrement())
  fappointmentId Int         @unique
  fcustomerId    Int
  orderPrice     Int
  fbarberId      Int
  Date           DateTime    @default(now())
  customer       Customer    @relation(fields: [fcustomerId], references: [customerId])
  barber         Barber      @relation(fields: [fbarberId], references: [barberid])
  appointment    Appointment @relation(fields: [fappointmentId], references: [appointmentId])
}

model Contact {
  ContactId Int      @id @unique @default(autoincrement())
  Name      String
  Email     String   @unique
  Message   String
  customer  Customer @relation(fields: [Email], references: [email])
}
